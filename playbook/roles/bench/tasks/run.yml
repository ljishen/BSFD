---
- name: ensure {{ benchmark.name }} workdir exists
  file:
    path: "{{ remote_workdir }}/{{ benchmark.name }}"
    state: directory

- name: copy run.sh script for {{ benchmark.name }} to remote location
  copy:
    dest: "{{ remote_workdir }}/{{ benchmark.name }}/run.sh"
    force: yes
    mode: 0755
    src: ../suite/{{ benchmark.name }}/run.sh 

- name: run {{ benchmark.desc }} using {{ benchmark.name }}
  include: run_specific.yml
  with_items: "{{ benchmark.configs }}"
  loop_control:
    loop_var: config

- name: clean remote workdir
  file:
    path: "{{ remote_workdir }}/{{ benchmark.name }}"
    state: absent
